{"ast":null,"code":"import React,{Fragment,useState,useEffect}from'react';import{ListGroup,ListGroupItem,Container,Row,Col,Card,CardBody,CardHeader,CardFooter,Media}from'reactstrap';import axios from\"axios\";import{connect}from\"react-redux\";import{NotificationManager}from'react-notifications';import\"./styles.css\";import Breadcrumb from'../../../../../layout/breadcrumb';import _ from\"lodash\";import ReactPlayer from'react-player';import PaginationEmployerListingHelper from\"../../../universal/pagination/paginationHelper.js\";import moment from\"moment\";import{useHistory}from'react-router-dom';// pagination settings and/or setup\nconst itemsPerPage=15;const ViewNotificationListHelper=_ref=>{let{userData}=_ref;const history=useHistory();const[notifications,setNotifications]=useState([]);const[ready,setReady]=useState(false);const[currentPage,setCurrentPage]=useState(0);const[pageCount,setPageCount]=useState(0);const[itemOffset,setItemOffset]=useState(0);const[immutableData,setImmutableData]=useState([]);useEffect(()=>{const endOffset=itemOffset+itemsPerPage;setPageCount(Math.ceil(immutableData.length/itemsPerPage));setNotifications(immutableData.slice(itemOffset,endOffset));},[itemOffset,itemsPerPage]);useEffect(()=>{const configuration={params:{uniqueId:userData.uniqueId,accountType:userData.accountType}};const promises=[];axios.get(\"\".concat(process.env.REACT_APP_BASE_URL,\"/gather/account/notifications\"),configuration).then(res=>{if(res.data.message===\"Successfully gathered notifications!\"){console.log(\"successfully bookmarked profile...:\",res.data);const{notifications}=res.data;for(let index=0;index<notifications.length;index++){const notify=notifications[index];promises.push(new Promise(async(resolve,reject)=>{const result=await axios.get(\"\".concat(process.env.REACT_APP_BASE_URL,\"/fetch/profile/pic/video/only\"),{params:{uniqueId:notify.metadata.from}});if(result.data.message===\"Gathered resource!\"){const file=result.data.file;notify.profilePicVideo=file;resolve(notify);}else{resolve(null);}}));}Promise.all(promises).then(passedData=>{console.log(\"passedData\",passedData);const endOffset=itemOffset+itemsPerPage;setPageCount(Math.ceil(passedData.length/itemsPerPage));setNotifications(passedData.slice(itemOffset,endOffset));setImmutableData(passedData);setReady(true);});}else{console.log(\"err\",res.data);NotificationManager.error(\"An unknown error has occurred while attempting to gather related profile notifications! Please reload the page or contact support if the problem persists..\",\"Error occurred while fetching notifications!\",4750);}}).catch(err=>{console.log(err);NotificationManager.error(\"An unknown error has occurred while attempting to gather related profile notifications! Please reload the page or contact support if the problem persists..\",\"Error occurred while fetching notifications!\",4750);});},[]);const renderProfilePicVideo=last=>{if(last!==null&&_.has(last,\"link\")){if(last.type.includes(\"video\")){// video logic\nreturn/*#__PURE__*/React.createElement(Media,{className:\"notification-pic-video\",body:true},/*#__PURE__*/React.createElement(ReactPlayer,{playing:true,loop:true,muted:true,width:\"100%\",className:\"notification-pic-video\",wrapper:\"div\",url:\"\".concat(process.env.REACT_APP_ASSET_LINK,\"/\").concat(last.link)}));}else{// image logic\nreturn/*#__PURE__*/React.createElement(Media,{className:\"notification-pic-video\",body:true,alt:\"profile-picture-sub\",src:\"\".concat(process.env.REACT_APP_ASSET_LINK,\"/\").concat(last.link),\"data-intro\":\"This is Profile image\"});}}else{// image logic\nreturn/*#__PURE__*/React.createElement(Media,{className:\"notification-pic-video\",body:true,alt:\"profile-picture-sub\",src:process.env.REACT_APP_PLACEHOLDER_IMAGE,\"data-intro\":\"This is Profile image\"});}};const calculateWhereToRedirect=data=>{console.log(\"calculateWhereToRedirect ran...!\");if(_.has(data,\"action\")&&data.action===\"video-invite\"){history.push(\"/start/video/interview/chat/employer/\".concat(data.metadata.attachments.attachment.generatedRoomID));}else{}};const handleNotificationClick=notification=>{console.log(\"handleNotificationClick clicked..\");const configuration={notification,uniqueId:userData.uniqueId,accountType:userData.accountType};axios.post(\"\".concat(process.env.REACT_APP_BASE_URL,\"/mark/notification/viewed/both/account/types\"),configuration).then(async res=>{if(res.data.message===\"Marked notification as seen!\"){console.log(\"Marked notification as seen!...:\",res.data);const{notification}=res.data;const findIndexNotification=notifications.findIndex(item=>item!==null&&item.id===notification.id);const shallowCopy=[...notifications];const result=await axios.get(\"\".concat(process.env.REACT_APP_BASE_URL,\"/fetch/profile/pic/video/only\"),{params:{uniqueId:notification.metadata.from}});if(result.data.message===\"Gathered resource!\"){const file=result.data.file;console.log(\"file\",file);notification.profilePicVideo=file;shallowCopy[findIndexNotification]=notification;console.log(\"shallowCopy\",shallowCopy);setNotifications(shallowCopy);NotificationManager.success(\"We've successfully marked this notification as 'read' or 'seen' - you will be redirected momentarily IF this notification has any related logic, otherwise no action will be taken.\",\"Successfully marked as viewed/seen!\",4750);calculateWhereToRedirect(notification);}else{NotificationManager.error(\"An unknown error has occurred while attempting mark notification as 'viewed' & process notification logic! Please reload the page or contact support if the problem persists..\",\"Error occurred while fetching notifications!\",4750);}// setNotifications(notifications);\n}else{console.log(\"err\",res.data);NotificationManager.error(\"An unknown error has occurred while attempting mark notification as 'viewed' & process notification logic! Please reload the page or contact support if the problem persists..\",\"Error occurred while fetching notifications!\",4750);}}).catch(err=>{console.log(err);NotificationManager.error(\"An unknown error has occurred while attempting mark notification as 'viewed' & process notification logic! Please reload the page or contact support if the problem persists..\",\"Error occurred while fetching notifications!\",4750);});};return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(Breadcrumb,{parent:\"Notification(s), Changes & Updates\",title:\"View & Manage Your Notification's!\"}),/*#__PURE__*/React.createElement(Container,{fluid:true},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:\"12\",md:\"12\",lg:\"12\",xl:\"12\"},/*#__PURE__*/React.createElement(Card,{className:\"shadow-notification-card\"},/*#__PURE__*/React.createElement(CardHeader,{className:\"b-l-primary b-r-primary\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"header-notification\"},\"View your notifications, manage updates & more! (click notifications to be redirected approriately)\"),/*#__PURE__*/React.createElement(\"p\",{className:\"lead\"},\"Click certain notifications will redirect you to the approriate changes/updates. Some notifications will not be linked to anything however some will, you can view your 'already viewed' notifications by the tinted color...\")),/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(ListGroup,null,typeof notifications!==\"undefined\"&&notifications.length>0?notifications.map((notification,index)=>{if(notification!==null){return/*#__PURE__*/React.createElement(Fragment,{key:index},/*#__PURE__*/React.createElement(ListGroupItem,{onClick:()=>handleNotificationClick(notification),className:notification.seenRead===true?\"list-group-item-action flex-column align-items-start notification-custom-notification active\":\"list-group-item-action flex-column align-items-start notification-custom-notification\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:\"12\",md:\"1\",lg:\"1\",xl:\"1\"},renderProfilePicVideo(notification.profilePicVideo)),/*#__PURE__*/React.createElement(Col,{sm:\"12\",md:\"11\",lg:\"11\",xl:\"11\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex w-100 justify-content-between\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"mb-1 maxed-title-notification\"},notification.title),/*#__PURE__*/React.createElement(\"small\",null,moment(notification.date).fromNow())),/*#__PURE__*/React.createElement(\"p\",{className:\"mb-1\"},notification.description),/*#__PURE__*/React.createElement(\"small\",null,notification.dateString)))));}}):/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"img\",{src:require(\"../../../../../assets/images/no-current-notifications.png\"),className:\"no-notifications-img\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"notification-pagination-wrapper\"},/*#__PURE__*/React.createElement(PaginationEmployerListingHelper,{itemsPerPage:itemsPerPage,loopingData:immutableData,currentPage:currentPage,pageCount:pageCount,setItemOffset:setItemOffset,setCurrentPage:setCurrentPage}))))))));};const mapStateToProps=state=>{return{userData:state.auth.data};};export default connect(mapStateToProps,{})(ViewNotificationListHelper);","map":{"version":3,"sources":["/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/src/components/dashboard/notifications/employers/viewNotificationList/viewNotifications.js"],"names":["React","Fragment","useState","useEffect","ListGroup","ListGroupItem","Container","Row","Col","Card","CardBody","CardHeader","CardFooter","Media","axios","connect","NotificationManager","Breadcrumb","_","ReactPlayer","PaginationEmployerListingHelper","moment","useHistory","itemsPerPage","ViewNotificationListHelper","userData","history","notifications","setNotifications","ready","setReady","currentPage","setCurrentPage","pageCount","setPageCount","itemOffset","setItemOffset","immutableData","setImmutableData","endOffset","Math","ceil","length","slice","configuration","params","uniqueId","accountType","promises","get","process","env","REACT_APP_BASE_URL","then","res","data","message","console","log","index","notify","push","Promise","resolve","reject","result","metadata","from","file","profilePicVideo","all","passedData","error","catch","err","renderProfilePicVideo","last","has","type","includes","REACT_APP_ASSET_LINK","link","REACT_APP_PLACEHOLDER_IMAGE","calculateWhereToRedirect","action","attachments","attachment","generatedRoomID","handleNotificationClick","notification","post","findIndexNotification","findIndex","item","id","shallowCopy","success","map","seenRead","title","date","fromNow","description","dateString","require","mapStateToProps","state","auth"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect } from 'react';\nimport { ListGroup, ListGroupItem, Container, Row, Col, Card, CardBody, CardHeader, CardFooter, Media } from 'reactstrap';\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport { NotificationManager } from 'react-notifications';\nimport \"./styles.css\";\nimport Breadcrumb from '../../../../../layout/breadcrumb';\nimport _ from \"lodash\";\nimport ReactPlayer from 'react-player';\nimport PaginationEmployerListingHelper from \"../../../universal/pagination/paginationHelper.js\";\nimport moment from \"moment\";\nimport { useHistory } from 'react-router-dom';\n\n\n// pagination settings and/or setup\nconst itemsPerPage = 15;\n\n\nconst ViewNotificationListHelper = ({ userData }) => {\n\n    const history = useHistory();\n\n    const [ notifications, setNotifications ] = useState([]);\n    const [ ready, setReady ] = useState(false);\n    const [ currentPage, setCurrentPage ] = useState(0);\n    const [ pageCount, setPageCount ] = useState(0);\n    const [ itemOffset, setItemOffset ] = useState(0);\n    const [ immutableData, setImmutableData ] = useState([]);\n\n    useEffect(() => {\n        const endOffset = itemOffset + itemsPerPage;\n\n        setPageCount(Math.ceil(immutableData.length / itemsPerPage));\n\n        setNotifications(immutableData.slice(itemOffset, endOffset));\n        \n    }, [ itemOffset, itemsPerPage ]);\n\n\n    useEffect(() => {\n        const configuration = {\n            params: {\n                uniqueId: userData.uniqueId,\n                accountType: userData.accountType \n            }\n        }\n\n        const promises = [];\n\n        axios.get(`${process.env.REACT_APP_BASE_URL}/gather/account/notifications`, configuration).then((res) => {\n            if (res.data.message === \"Successfully gathered notifications!\") {\n                console.log(\"successfully bookmarked profile...:\", res.data);\n\n                const { notifications } = res.data;\n\n                for (let index = 0; index < notifications.length; index++) {\n                    const notify = notifications[index];\n                    \n                    promises.push(new Promise(async (resolve, reject) => {\n                        const result = await axios.get(`${process.env.REACT_APP_BASE_URL}/fetch/profile/pic/video/only`, {\n                            params: {\n                                uniqueId: notify.metadata.from\n                            }\n                        })\n\n                        if (result.data.message === \"Gathered resource!\") {\n                            const file = result.data.file;\n\n                            notify.profilePicVideo = file;\n\n                            resolve(notify);\n                        } else {\n                            resolve(null);\n                        }\n                    }))\n                }\n\n                Promise.all(promises).then((passedData) => {\n                    console.log(\"passedData\", passedData);\n\n                    const endOffset = itemOffset + itemsPerPage;\n\n                    setPageCount(Math.ceil(passedData.length / itemsPerPage));\n\n                    setNotifications(passedData.slice(itemOffset, endOffset));\n                    setImmutableData(passedData);\n                    setReady(true);\n                })\n            } else {\n                console.log(\"err\", res.data);\n\n                NotificationManager.error(\"An unknown error has occurred while attempting to gather related profile notifications! Please reload the page or contact support if the problem persists..\", \"Error occurred while fetching notifications!\", 4750);\n            }\n        }).catch((err) => {\n            console.log(err);\n\n            NotificationManager.error(\"An unknown error has occurred while attempting to gather related profile notifications! Please reload the page or contact support if the problem persists..\", \"Error occurred while fetching notifications!\", 4750);\n        })\n    }, []);\n\n    const renderProfilePicVideo = (last) => {\n        if (last !== null && _.has(last, \"link\")) {\n            if (last.type.includes(\"video\")) {\n                // video logic\n                return (\n                    <Media className=\"notification-pic-video\" body>\n                        <ReactPlayer playing={true} loop={true} muted={true} width={\"100%\"} className={\"notification-pic-video\"} wrapper={\"div\"} url={`${process.env.REACT_APP_ASSET_LINK}/${last.link}`} />\n                    </Media>\n                );\n            } else {\n                // image logic\n                return <Media className=\"notification-pic-video\" body alt=\"profile-picture-sub\" src={`${process.env.REACT_APP_ASSET_LINK}/${last.link}`} data-intro=\"This is Profile image\" />;\n            }  \n        } else {\n            // image logic\n            return <Media className=\"notification-pic-video\" body alt=\"profile-picture-sub\" src={process.env.REACT_APP_PLACEHOLDER_IMAGE} data-intro=\"This is Profile image\" />;\n        } \n    }\n\n    const calculateWhereToRedirect = (data) => {\n        console.log(\"calculateWhereToRedirect ran...!\");\n\n        if (_.has(data, \"action\") && data.action === \"video-invite\") {\n            history.push(`/start/video/interview/chat/employer/${data.metadata.attachments.attachment.generatedRoomID}`);\n        } else {\n            \n        }\n    }\n\n    const handleNotificationClick = (notification) => {\n        console.log(\"handleNotificationClick clicked..\");\n\n        const configuration = {\n            notification,\n            uniqueId: userData.uniqueId,\n            accountType: userData.accountType\n        }\n\n        axios.post(`${process.env.REACT_APP_BASE_URL}/mark/notification/viewed/both/account/types`, configuration).then(async (res) => {\n            if (res.data.message === \"Marked notification as seen!\") {\n                console.log(\"Marked notification as seen!...:\", res.data);\n\n                const { notification } = res.data;\n\n                const findIndexNotification = notifications.findIndex((item) => item !== null && item.id === notification.id);\n\n                const shallowCopy = [...notifications];\n\n                const result = await axios.get(`${process.env.REACT_APP_BASE_URL}/fetch/profile/pic/video/only`, {\n                    params: {\n                        uniqueId: notification.metadata.from\n                    }\n                })\n\n                if (result.data.message === \"Gathered resource!\") {\n                    const file = result.data.file;\n\n                    console.log(\"file\", file);\n\n                    notification.profilePicVideo = file;\n\n                    shallowCopy[findIndexNotification] = notification;\n\n                    console.log(\"shallowCopy\", shallowCopy);\n\n                    setNotifications(shallowCopy);\n\n                    NotificationManager.success(\"We've successfully marked this notification as 'read' or 'seen' - you will be redirected momentarily IF this notification has any related logic, otherwise no action will be taken.\", \"Successfully marked as viewed/seen!\", 4750);\n\n                    calculateWhereToRedirect(notification);\n                } else {\n                    NotificationManager.error(\"An unknown error has occurred while attempting mark notification as 'viewed' & process notification logic! Please reload the page or contact support if the problem persists..\", \"Error occurred while fetching notifications!\", 4750);\n                }\n\n                // setNotifications(notifications);\n            } else {\n                console.log(\"err\", res.data);\n\n                NotificationManager.error(\"An unknown error has occurred while attempting mark notification as 'viewed' & process notification logic! Please reload the page or contact support if the problem persists..\", \"Error occurred while fetching notifications!\", 4750);\n            }\n        }).catch((err) => {\n            console.log(err);\n\n            NotificationManager.error(\"An unknown error has occurred while attempting mark notification as 'viewed' & process notification logic! Please reload the page or contact support if the problem persists..\", \"Error occurred while fetching notifications!\", 4750);\n        })\n    }\n\n    return (\n        <Fragment>\n            <Breadcrumb parent=\"Notification(s), Changes & Updates\" title=\"View & Manage Your Notification's!\" />\n            <Container fluid={true}>\n                <Row>\n                    <Col sm=\"12\" md=\"12\" lg=\"12\" xl=\"12\">\n                        <Card className='shadow-notification-card'>\n                            <CardHeader className='b-l-primary b-r-primary'>\n                                <h4 className='header-notification'>View your notifications, manage updates & more! (click notifications to be redirected approriately)</h4>\n                                <p className='lead'>Click certain notifications will redirect you to the approriate changes/updates. Some notifications will not be linked to anything however some will, you can view your 'already viewed' notifications by the tinted color...</p>\n                            </CardHeader>\n                            <CardBody>\n                                <ListGroup>\n                                    {typeof notifications !== \"undefined\" && notifications.length > 0 ? notifications.map((notification, index) => {\n                                        if (notification !== null) {\n                                            return (\n                                                <Fragment key={index}>\n                                                    <ListGroupItem onClick={() => handleNotificationClick(notification)} className={notification.seenRead === true ? \"list-group-item-action flex-column align-items-start notification-custom-notification active\" : \"list-group-item-action flex-column align-items-start notification-custom-notification\"}>\n                                                        <Row>\n                                                            <Col sm=\"12\" md=\"1\" lg=\"1\" xl=\"1\">\n                                                                {renderProfilePicVideo(notification.profilePicVideo)}\n                                                            </Col>\n                                                            <Col sm=\"12\" md=\"11\" lg=\"11\" xl=\"11\">\n                                                                <div className=\"d-flex w-100 justify-content-between\">\n                                                                    <h5 className=\"mb-1 maxed-title-notification\">{notification.title}</h5><small>{moment(notification.date).fromNow()}</small>\n                                                                </div>\n                                                                <p className=\"mb-1\">{notification.description}</p>\n                                                                <small>{notification.dateString}</small>\n                                                            </Col>\n                                                        </Row>\n                                                    </ListGroupItem>\n                                                </Fragment>\n                                            );\n                                        }\n                                    }) : <Fragment>\n                                        <img src={require(\"../../../../../assets/images/no-current-notifications.png\")} className={\"no-notifications-img\"} />\n                                    </Fragment>}\n                                </ListGroup>\n                                <div className='notification-pagination-wrapper'>\n                                    <PaginationEmployerListingHelper itemsPerPage={itemsPerPage} loopingData={immutableData} currentPage={currentPage} pageCount={pageCount} setItemOffset={setItemOffset} setCurrentPage={setCurrentPage}  />\n                                </div>\n                            </CardBody>\n                        </Card>\n                    </Col>\n                </Row>\n            </Container>\n        </Fragment>\n    );\n}\nconst mapStateToProps = (state) => {\n    return {\n        userData: state.auth.data\n    }\n}\nexport default connect(mapStateToProps, { })(ViewNotificationListHelper);"]},"metadata":{},"sourceType":"module"}