{"ast":null,"code":"import React,{Fragment,useState,useEffect,useRef}from'react';import\"./styles.css\";import{Row,Col,Media,Input,Label,Button,Form}from'reactstrap';import axios from'axios';import{connect}from\"react-redux\";import{useForm,Controller}from'react-hook-form';import MainHooksCourseIndividualCustomHelpers from\"./helpers/reduxFormHelper.js\";import ReactPlayer from\"react-player\";import helpers from\"./helpers/helperFunctions.js\";import{NotificationManager}from'react-notifications';import uuid from\"react-uuid\";import PaginationEmployerListingHelper from\"../../../../../universal/pagination/paginationHelper.js\";const checkMessageMeetsCritera=MainHooksCourseIndividualCustomHelpers().checkMessageMeetsCritera;// pagination settings and/or setup\nconst itemsPerPage=5;const{RenderPopoverEmojiLogic,RenderEmojiLogic}=helpers;const CommentsIndividualCourseHelper=_ref=>{let{courseData,userData}=_ref;const{register,handleSubmit,getValues,setValue,setError,clearErrors,formState:{errors}}=useForm({mode:\"onTouched\",reValidateMode:\"onBlur\"});const[comments,setCommentsState]=useState([]);const[popover,setPopoverState]=useState({});const[currentPage,setCurrentPage]=useState(0);const[pageCount,setPageCount]=useState(0);const[itemOffset,setItemOffset]=useState(0);// render EVERY CHANGE to pagination\nuseEffect(()=>{const endOffset=itemOffset+itemsPerPage;setPageCount(Math.ceil(courseData.comments.length/itemsPerPage));setCommentsState(courseData.comments.slice(itemOffset,endOffset));},[itemOffset,itemsPerPage]);useEffect(()=>{// create comment popover state's\nsetPopoverState(()=>{const newObjCount={};const comments=courseData.comments;// reassign state items in preperation for future state changes...\nfor(const keyyy in comments){newObjCount[\"comment\".concat(keyyy)]=false;}return newObjCount;});},[]);const currentValues=getValues();const onSubmitForm=data=>{console.log(\"onSubmitForm submitted form properly...!:\",data);const{comment}=data;const configuration={id:userData.uniqueId,courseId:courseData.id,comment,firstName:userData.firstName,lastName:userData.lastName,accountType:userData.accountType,mostRecentProfilePicVideo:typeof userData.profilePicsVideos!==\"undefined\"&&userData.profilePicsVideos.length>0?userData.profilePicsVideos[userData.profilePicsVideos.length-1]:null};axios.post(\"\".concat(process.env.REACT_APP_BASE_URL,\"/post/comment/course/individual/listing\"),configuration).then(res=>{if(res.data.message===\"Successfully posted comment!\"){console.log(res.data);const{updatedComments}=res.data;setValue(\"comment\",\"\",{shouldValidate:false});setCommentsState(updatedComments);}else{console.log(\"Err\",res.data);}}).catch(err=>{console.log(err);});};const handleRespondEmoji=(emojiName,comment,closePopover,targetAndPopState)=>{console.log(\"emojiName\",emojiName);const configuration={emojiName,id:userData.uniqueId,courseId:courseData.id,commentID:comment.id,comment};axios.post(\"\".concat(process.env.REACT_APP_BASE_URL,\"/respond/emoji/comment/course/learning\"),configuration).then(res=>{if(res.data.message===\"Successfully reacted to comment!\"){console.log(res.data);const{course,commenttt}=res.data;NotificationManager.success(\"Successfully REACTED to the selected comment, Your response is now live!\",\"Successfully reacted to comment!\",4500);const indexed=comments.findIndex(x=>x.id===commenttt.id);const copy=[...comments];copy[indexed]=commenttt;setCommentsState(copy);closePopover(targetAndPopState);}else if(res.data.message===\"You've already reacted to this comment! Since you've previously reacted, we're removing your existing response so you can update it!\"){const{course,commenttt}=res.data;NotificationManager.warning(res.data.message,\"Successfully redacted your existing response!\",4500);const indexed=comments.findIndex(x=>x.id===commenttt.id);const copy=[...comments];copy[indexed]=commenttt;setCommentsState(copy);closePopover(targetAndPopState);}else{console.log(\"Err\",res.data);}}).catch(err=>{console.log(err);});};const renderFormErrors=errors=>{console.log(\"renderFormErrors\",errors);};const renderCommentPicOrVideo=file=>{if(file.type.includes(\"video\")){// video logic\nreturn/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\"},/*#__PURE__*/React.createElement(ReactPlayer,{playing:true,loop:true,muted:true,width:\"100%\",className:\"media-body align-self-center maxed-out-video-course-profile\",wrapper:\"div\",url:\"\".concat(process.env.REACT_APP_ASSET_LINK,\"/\").concat(file.link)})));}else{// image logic\nreturn/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\"},/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\",src:\"\".concat(process.env.REACT_APP_ASSET_LINK,\"/\").concat(file.link),alt:\"\"})));}};return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"section\",{className:\"comment-box\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Comment's\"),/*#__PURE__*/React.createElement(Form,{onSubmit:handleSubmit(onSubmitForm,errors=>renderFormErrors(errors))},/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(Label,{className:\"heavy-label-course\"},checkMessageMeetsCritera.label),/*#__PURE__*/React.createElement(Input,Object.assign({},checkMessageMeetsCritera.check(setError,register,clearErrors,\"comment\"),{onChange:e=>{checkMessageMeetsCritera.onChange(e,\"comment\",setValue);const caret=e.target.selectionStart;const element=e.target;window.requestAnimationFrame(()=>{element.selectionStart=caret;element.selectionEnd=caret;});},value:currentValues.comment,name:\"comment\",className:\"form-control\",rows:6,type:\"textarea\",placeholder:checkMessageMeetsCritera.placeholder})),errors.comment?/*#__PURE__*/React.createElement(\"span\",{className:\"span-tooltip\"},errors.comment.message):null,/*#__PURE__*/React.createElement(\"div\",{className:\"float-right-course-comment-btn\"},/*#__PURE__*/React.createElement(Button,{type:\"submit\",className:\"btn-square-primary\",color:\"primary-2x\",outline:true},\"Leave/Post Comment!\")),/*#__PURE__*/React.createElement(\"hr\",null)),/*#__PURE__*/React.createElement(\"ul\",{className:\"comment-list-course-ul\"},typeof comments!==\"undefined\"&&comments.length>0?comments.map((comment,index)=>{console.log(\"comment\",comment);const popoverIDTarget=\"comment\".concat(index);return/*#__PURE__*/React.createElement(Fragment,{key:uuid()},/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\"},comment.posterPicOrVideo!==null?renderCommentPicOrVideo(comment.posterPicOrVideo):/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\",src:require(\"../../../../../../../assets/images/blog/comment.jpg\"),alt:\"\"}),/*#__PURE__*/React.createElement(Media,{body:true},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"4 xl-100\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"mt-0\"},comment.posterName,/*#__PURE__*/React.createElement(\"span\",null,\" \",comment.posterAccountType===\"hackers\"?\"Hacker/Coder\":\"Employer\")),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(RenderEmojiLogic,{comments:comments,reactions:comment.reactions}))),/*#__PURE__*/React.createElement(Col,{md:\"8 xl-100\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"comment-social float-left float-md-right learning-comment\"},/*#__PURE__*/React.createElement(\"li\",{id:popoverIDTarget,onClick:()=>{setPopoverState(prevState=>{return{...prevState,[\"comment\".concat(index)]:true};});},className:\"digits custom-digit-react-emoji\"},/*#__PURE__*/React.createElement(\"i\",{className:\"icofont icofont-ui-rate-add\"}),\"React to post w/emoji\"),/*#__PURE__*/React.createElement(RenderPopoverEmojiLogic,{handleRespondEmoji:handleRespondEmoji,comment:comment,courseData:courseData,userData:userData,reactions:comment.reactions,setPopoverState:setPopoverState,popoverState:popover,targetAndPopState:popoverIDTarget})))),/*#__PURE__*/React.createElement(\"p\",null,comment.commentText)))),typeof comment.subComments!==\"undefined\"&&comment.subComments.length>0?comment.subComments.map((subcomment,idx)=>{console.log(\"sub-comment\",subcomment);return/*#__PURE__*/React.createElement(\"li\",{key:idx},/*#__PURE__*/React.createElement(\"ul\",null,/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(Media,null,/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\",src:require(\"../../../../../../../assets/images/blog/9.jpg\"),alt:\"\"}),/*#__PURE__*/React.createElement(Media,{body:true},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{xl:\"12\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"mt-0\"},\"Name goes here\",/*#__PURE__*/React.createElement(\"span\",null,\" \",\"( Designer )\")))),/*#__PURE__*/React.createElement(\"p\",null,\"There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isn't anything embarrassing hidden in the middle of text.\"))))));}):null);}):null)),/*#__PURE__*/React.createElement(Row,{style:{marginTop:\"27.5px\",marginBottom:\"55px\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"centered-both-ways\"},/*#__PURE__*/React.createElement(PaginationEmployerListingHelper,{itemsPerPage:itemsPerPage,setItemOffset:setItemOffset,loopingData:courseData.comments,setPageCount:setPageCount,pageCount:pageCount,currentPage:currentPage,setCurrentPage:setCurrentPage}))));};const mapStateToProps=state=>{return{userData:state.auth.data};};export default connect(mapStateToProps,{})(CommentsIndividualCourseHelper);","map":{"version":3,"sources":["/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/src/components/dashboard/learning/educationalCoursesSeminars/viewCourses/helpers/comments/renderCommentSection.js"],"names":["React","Fragment","useState","useEffect","useRef","Row","Col","Media","Input","Label","Button","Form","axios","connect","useForm","Controller","MainHooksCourseIndividualCustomHelpers","ReactPlayer","helpers","NotificationManager","uuid","PaginationEmployerListingHelper","checkMessageMeetsCritera","itemsPerPage","RenderPopoverEmojiLogic","RenderEmojiLogic","CommentsIndividualCourseHelper","courseData","userData","register","handleSubmit","getValues","setValue","setError","clearErrors","formState","errors","mode","reValidateMode","comments","setCommentsState","popover","setPopoverState","currentPage","setCurrentPage","pageCount","setPageCount","itemOffset","setItemOffset","endOffset","Math","ceil","length","slice","newObjCount","keyyy","currentValues","onSubmitForm","data","console","log","comment","configuration","id","uniqueId","courseId","firstName","lastName","accountType","mostRecentProfilePicVideo","profilePicsVideos","post","process","env","REACT_APP_BASE_URL","then","res","message","updatedComments","shouldValidate","catch","err","handleRespondEmoji","emojiName","closePopover","targetAndPopState","commentID","course","commenttt","success","indexed","findIndex","x","copy","warning","renderFormErrors","renderCommentPicOrVideo","file","type","includes","REACT_APP_ASSET_LINK","link","label","check","e","onChange","caret","target","selectionStart","element","window","requestAnimationFrame","selectionEnd","placeholder","map","index","popoverIDTarget","posterPicOrVideo","require","posterName","posterAccountType","reactions","prevState","commentText","subComments","subcomment","idx","marginTop","marginBottom","mapStateToProps","state","auth"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect, useRef } from 'react';\nimport \"./styles.css\";\nimport { Row, Col, Media, Input, Label, Button, Form } from 'reactstrap';\nimport axios from 'axios';\nimport { connect } from \"react-redux\";\nimport { useForm, Controller } from 'react-hook-form';\nimport MainHooksCourseIndividualCustomHelpers from \"./helpers/reduxFormHelper.js\";\nimport ReactPlayer from \"react-player\";\nimport helpers from \"./helpers/helperFunctions.js\";\nimport { NotificationManager } from 'react-notifications';\nimport uuid from \"react-uuid\";\nimport PaginationEmployerListingHelper from \"../../../../../universal/pagination/paginationHelper.js\";\n\n\nconst checkMessageMeetsCritera = MainHooksCourseIndividualCustomHelpers().checkMessageMeetsCritera;\n// pagination settings and/or setup\nconst itemsPerPage = 5;\n\nconst { RenderPopoverEmojiLogic, RenderEmojiLogic } = helpers;\n\nconst CommentsIndividualCourseHelper = ({ courseData, userData }) => {\n\n    const { register, handleSubmit, getValues, setValue, setError, clearErrors, formState: { errors }} = useForm({\n        mode: \"onTouched\",\n        reValidateMode: \"onBlur\"\n    });\n\n    const [ comments, setCommentsState ] = useState([]);\n    const [ popover, setPopoverState ] = useState({}); \n    const [ currentPage, setCurrentPage ] = useState(0);\n    const [ pageCount, setPageCount ] = useState(0);\n    const [ itemOffset, setItemOffset ] = useState(0);\n\n    // render EVERY CHANGE to pagination\n    useEffect(() => {\n        const endOffset = itemOffset + itemsPerPage;\n\n        setPageCount(Math.ceil(courseData.comments.length / itemsPerPage));\n\n        setCommentsState(courseData.comments.slice(itemOffset, endOffset));\n        \n    }, [itemOffset, itemsPerPage]);\n\n    useEffect(() => {\n        // create comment popover state's\n        setPopoverState(() => {\n            const newObjCount = {};\n            const comments = courseData.comments;\n            // reassign state items in preperation for future state changes...\n            for (const keyyy in comments) {\n                newObjCount[`comment${keyyy}`] = false;\n            }\n            return newObjCount;\n        })\n    }, []);\n\n    const currentValues = getValues();\n\n    const onSubmitForm = (data) => {\n        console.log(\"onSubmitForm submitted form properly...!:\", data);\n\n        const { comment } = data;\n\n        const configuration = {\n            id: userData.uniqueId,\n            courseId: courseData.id,\n            comment,\n            firstName: userData.firstName,\n            lastName: userData.lastName,\n            accountType: userData.accountType,\n            mostRecentProfilePicVideo: typeof userData.profilePicsVideos !== \"undefined\" && userData.profilePicsVideos.length > 0 ? userData.profilePicsVideos[userData.profilePicsVideos.length - 1] : null\n        }\n\n        axios.post(`${process.env.REACT_APP_BASE_URL}/post/comment/course/individual/listing`, configuration).then((res) => {\n            if (res.data.message === \"Successfully posted comment!\") {\n                console.log(res.data);\n\n                const { updatedComments } = res.data;\n\n                setValue(\"comment\", \"\", { shouldValidate: false });\n\n                setCommentsState(updatedComments);\n\n            } else {\n                console.log(\"Err\", res.data);\n            }\n        }).catch((err) => {\n            console.log(err);\n        })\n    }\n    const handleRespondEmoji = (emojiName, comment, closePopover, targetAndPopState) => {\n        console.log(\"emojiName\", emojiName);\n\n        const configuration = {\n            emojiName,\n            id: userData.uniqueId,\n            courseId: courseData.id,\n            commentID: comment.id,\n            comment\n        };\n\n        axios.post(`${process.env.REACT_APP_BASE_URL}/respond/emoji/comment/course/learning`, configuration).then((res) => {\n            if (res.data.message === \"Successfully reacted to comment!\") {\n                console.log(res.data);\n\n                const { course, commenttt } = res.data;\n\n                NotificationManager.success(\"Successfully REACTED to the selected comment, Your response is now live!\", \"Successfully reacted to comment!\", 4500);\n\n                const indexed = comments.findIndex(x => x.id === commenttt.id);\n\n                const copy = [...comments];\n                copy[indexed] = commenttt;\n                \n                setCommentsState(copy);\n\n                closePopover(targetAndPopState);\n            } else if (res.data.message === \"You've already reacted to this comment! Since you've previously reacted, we're removing your existing response so you can update it!\") {\n                const { course, commenttt } = res.data;\n\n                NotificationManager.warning(res.data.message, \"Successfully redacted your existing response!\", 4500);\n\n                const indexed = comments.findIndex(x => x.id === commenttt.id);\n\n                const copy = [...comments];\n                copy[indexed] = commenttt;\n                \n                setCommentsState(copy);\n\n                closePopover(targetAndPopState);\n            } else {\n                console.log(\"Err\", res.data);\n            }\n        }).catch((err) => {\n            console.log(err);\n        })\n    }\n    const renderFormErrors = (errors) => {\n        console.log(\"renderFormErrors\", errors);\n    }\n    const renderCommentPicOrVideo = (file) => {\n        if (file.type.includes(\"video\")) {\n            // video logic\n            return (\n                <Fragment>\n                    <Media className=\"align-self-center\">\n                        <ReactPlayer playing={true} loop={true} muted={true} width={\"100%\"} className={\"media-body align-self-center maxed-out-video-course-profile\"} wrapper={\"div\"} url={`${process.env.REACT_APP_ASSET_LINK}/${file.link}`} />\n                    </Media> \n                </Fragment>\n            );\n        } else {\n            // image logic\n            return (\n                <Fragment>\n                    <Media className=\"align-self-center\">\n                        <Media className=\"align-self-center\" src={`${process.env.REACT_APP_ASSET_LINK}/${file.link}`} alt=\"\"/>\n                    </Media>\n                </Fragment>\n            );\n        }  \n    }\n    return (\n        <Fragment>\n            <section className=\"comment-box\">\n                <h4>Comment's</h4>\n                <Form onSubmit={handleSubmit(onSubmitForm, (errors) => renderFormErrors(errors))}>\n                    <hr/>\n                        <Label className={\"heavy-label-course\"}>{checkMessageMeetsCritera.label}</Label>\n                        <Input {...checkMessageMeetsCritera.check(setError, register, clearErrors, \"comment\")} onChange={(e) => {\n\n                            checkMessageMeetsCritera.onChange(e, \"comment\", setValue);\n\n                            const caret = e.target.selectionStart;\n                            const element = e.target;\n                            window.requestAnimationFrame(() => {\n                                element.selectionStart = caret\n                                element.selectionEnd = caret\n                            })\n                        }} value={currentValues.comment} name={\"comment\"} className={\"form-control\"} rows={6} type={\"textarea\"} placeholder={checkMessageMeetsCritera.placeholder} />\n                        {errors.comment ? <span className=\"span-tooltip\">{errors.comment.message}</span> : null}\n                        <div className={\"float-right-course-comment-btn\"}>\n                            <Button type={\"submit\"} className={\"btn-square-primary\"} color={\"primary-2x\"} outline>Leave/Post Comment!</Button>\n                        </div>\n                    <hr />\n                </Form>\n                <ul className={\"comment-list-course-ul\"}>\n                    {typeof comments !== \"undefined\" && comments.length > 0 ? comments.map((comment, index) => {\n                        console.log(\"comment\", comment);\n\n                        const popoverIDTarget = `comment${index}`;\n                        return (\n                            <Fragment key={uuid()}>\n                                <li>\n                                    <Media className=\"align-self-center\">\n                                        {comment.posterPicOrVideo !== null ? renderCommentPicOrVideo(comment.posterPicOrVideo) : <Media className=\"align-self-center\" src={require(\"../../../../../../../assets/images/blog/comment.jpg\")} alt=\"\"/>}\n                                        <Media body>\n                                            <Row>\n                                                <Col md=\"4 xl-100\">\n                                                    <h6 className=\"mt-0\">{comment.posterName}<span> {comment.posterAccountType === \"hackers\" ? \"Hacker/Coder\" : \"Employer\"}</span></h6><Row><RenderEmojiLogic comments={comments} reactions={comment.reactions} /></Row>\n                                                </Col>\n                                                <Col md=\"8 xl-100\">\n                                                    <ul className=\"comment-social float-left float-md-right learning-comment\">\n                                                    {/* <li className=\"digits\"><i className=\"icofont icofont-thumbs-up\"></i>{\"02 Hits\"}</li> */}\n                                                    <li id={popoverIDTarget} onClick={() => {\n                                                        setPopoverState(prevState => {\n                                                            return {\n                                                                ...prevState,\n                                                                [`comment${index}`]: true\n                                                            }\n                                                        });\n                                                    }} className=\"digits custom-digit-react-emoji\"><i className=\"icofont icofont-ui-rate-add\"></i>{\"React to post w/emoji\"}</li>\n                                                    <RenderPopoverEmojiLogic handleRespondEmoji={handleRespondEmoji} comment={comment} courseData={courseData} userData={userData} reactions={comment.reactions} setPopoverState={setPopoverState} popoverState={popover} targetAndPopState={popoverIDTarget} />\n                                                    </ul>\n                                                </Col>\n                                            </Row>\n                                            <p>{comment.commentText}</p>\n                                        </Media>\n                                    </Media>\n                                </li>\n                                {typeof comment.subComments !== \"undefined\" && comment.subComments.length > 0 ? comment.subComments.map((subcomment, idx) => {\n                                    console.log(\"sub-comment\", subcomment);\n                                    return (\n                                        <li key={idx}>\n                                            <ul>\n                                                <li>\n                                                    <Media><Media className=\"align-self-center\" src={require(\"../../../../../../../assets/images/blog/9.jpg\")} alt=\"\"/>\n                                                    <Media body>\n                                                        <Row>\n                                                        <Col xl=\"12\">\n                                                            <h6 className=\"mt-0\">Name goes here<span> {\"( Designer )\"}</span></h6>\n                                                        </Col>\n                                                        </Row>\n                                                        <p>{\"There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isn't anything embarrassing hidden in the middle of text.\"}</p>\n                                                    </Media>\n                                                    </Media>\n                                                </li>\n                                            </ul>\n                                        </li>\n                                    );\n                                }) : null}\n                            </Fragment>\n                        );\n                    }) : null}\n                </ul>\n            </section>\n            <Row style={{ marginTop: \"27.5px\", marginBottom: \"55px\" }}>\n                <div className=\"centered-both-ways\">\n                    <PaginationEmployerListingHelper itemsPerPage={itemsPerPage} setItemOffset={setItemOffset} loopingData={courseData.comments} setPageCount={setPageCount} pageCount={pageCount} currentPage={currentPage} setCurrentPage={setCurrentPage} />\n                </div>\n            </Row>\n        </Fragment>\n    );\n}\nconst mapStateToProps = (state) => {\n    return {\n        userData: state.auth.data\n    }\n}\nexport default connect(mapStateToProps, {  })(CommentsIndividualCourseHelper);\n"]},"metadata":{},"sourceType":"module"}