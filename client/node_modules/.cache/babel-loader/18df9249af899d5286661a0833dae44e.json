{"ast":null,"code":"import _defineProperty from \"/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/src/components/dashboard/learning/educationalCoursesSeminars/viewCourses/helpers/comments/renderCommentSection.js\";\n\nimport React, { Fragment, useState, useEffect, useRef } from 'react';\nimport \"./styles.css\";\nimport { Row, Col, Media, Input, Label, Button, Form } from 'reactstrap';\nimport axios from 'axios';\nimport { connect } from \"react-redux\";\nimport { useForm, Controller } from 'react-hook-form';\nimport MainHooksCourseIndividualCustomHelpers from \"./helpers/reduxFormHelper.js\";\nimport ReactPlayer from \"react-player\";\nimport helpers from \"./helpers/helperFunctions.js\";\nimport { NotificationManager } from 'react-notifications';\nimport uuid from \"react-uuid\";\nimport PaginationEmployerListingHelper from \"../../../../../universal/pagination/paginationHelper.js\";\nvar checkMessageMeetsCritera = MainHooksCourseIndividualCustomHelpers().checkMessageMeetsCritera; // pagination settings and/or setup\n\nvar itemsPerPage = 5;\nvar RenderPopoverEmojiLogic = helpers.RenderPopoverEmojiLogic,\n    RenderEmojiLogic = helpers.RenderEmojiLogic;\n\nvar CommentsIndividualCourseHelper = function CommentsIndividualCourseHelper(_ref) {\n  var courseData = _ref.courseData,\n      userData = _ref.userData;\n\n  var _useForm = useForm({\n    mode: \"onTouched\",\n    reValidateMode: \"onBlur\"\n  }),\n      register = _useForm.register,\n      handleSubmit = _useForm.handleSubmit,\n      getValues = _useForm.getValues,\n      setValue = _useForm.setValue,\n      setError = _useForm.setError,\n      clearErrors = _useForm.clearErrors,\n      errors = _useForm.formState.errors;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      comments = _useState2[0],\n      setCommentsState = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      popover = _useState4[0],\n      setPopoverState = _useState4[1];\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      currentPage = _useState6[0],\n      setCurrentPage = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      pageCount = _useState8[0],\n      setPageCount = _useState8[1];\n\n  var _useState9 = useState(0),\n      _useState10 = _slicedToArray(_useState9, 2),\n      itemOffset = _useState10[0],\n      setItemOffset = _useState10[1]; // render EVERY CHANGE to pagination\n\n\n  useEffect(function () {\n    var endOffset = itemOffset + itemsPerPage;\n    setPageCount(Math.ceil(courseData.comments.length / itemsPerPage));\n    setCommentsState(courseData.comments.slice(itemOffset, endOffset));\n  }, [itemOffset, itemsPerPage]);\n  useEffect(function () {\n    // create comment popover state's\n    setPopoverState(function () {\n      var newObjCount = {};\n      var comments = courseData.comments; // reassign state items in preperation for future state changes...\n\n      for (var keyyy in comments) {\n        newObjCount[\"comment\".concat(keyyy)] = false;\n      }\n\n      return newObjCount;\n    });\n  }, []);\n  var currentValues = getValues();\n\n  var onSubmitForm = function onSubmitForm(data) {\n    console.log(\"onSubmitForm submitted form properly...!:\", data);\n    var comment = data.comment;\n    var configuration = {\n      id: userData.uniqueId,\n      courseId: courseData.id,\n      comment: comment,\n      firstName: userData.firstName,\n      lastName: userData.lastName,\n      accountType: userData.accountType,\n      mostRecentProfilePicVideo: typeof userData.profilePicsVideos !== \"undefined\" && userData.profilePicsVideos.length > 0 ? userData.profilePicsVideos[userData.profilePicsVideos.length - 1] : null\n    };\n    axios.post(\"\".concat(process.env.REACT_APP_BASE_URL, \"/post/comment/course/individual/listing\"), configuration).then(function (res) {\n      if (res.data.message === \"Successfully posted comment!\") {\n        console.log(res.data);\n        var updatedComments = res.data.updatedComments;\n        setValue(\"comment\", \"\", {\n          shouldValidate: false\n        });\n        setCommentsState(updatedComments);\n      } else {\n        console.log(\"Err\", res.data);\n      }\n    }).catch(function (err) {\n      console.log(err);\n    });\n  };\n\n  var handleRespondEmoji = function handleRespondEmoji(emojiName, comment, closePopover, targetAndPopState) {\n    console.log(\"emojiName\", emojiName);\n    var configuration = {\n      emojiName: emojiName,\n      id: userData.uniqueId,\n      courseId: courseData.id,\n      commentID: comment.id,\n      comment: comment\n    };\n    axios.post(\"\".concat(process.env.REACT_APP_BASE_URL, \"/respond/emoji/comment/course/learning\"), configuration).then(function (res) {\n      if (res.data.message === \"Successfully reacted to comment!\") {\n        console.log(res.data);\n        var _res$data = res.data,\n            course = _res$data.course,\n            commenttt = _res$data.commenttt;\n        NotificationManager.success(\"Successfully REACTED to the selected comment, Your response is now live!\", \"Successfully reacted to comment!\", 4500);\n        var indexed = comments.findIndex(function (x) {\n          return x.id === commenttt.id;\n        });\n\n        var copy = _toConsumableArray(comments);\n\n        copy[indexed] = commenttt;\n        setCommentsState(copy);\n        closePopover(targetAndPopState);\n      } else if (res.data.message === \"You've already reacted to this comment! Since you've previously reacted, we're removing your existing response so you can update it!\") {\n        var _res$data2 = res.data,\n            _course = _res$data2.course,\n            _commenttt = _res$data2.commenttt;\n        NotificationManager.warning(res.data.message, \"Successfully redacted your existing response!\", 4500);\n\n        var _indexed = comments.findIndex(function (x) {\n          return x.id === _commenttt.id;\n        });\n\n        var _copy = _toConsumableArray(comments);\n\n        _copy[_indexed] = _commenttt;\n        setCommentsState(_copy);\n        closePopover(targetAndPopState);\n      } else {\n        console.log(\"Err\", res.data);\n      }\n    }).catch(function (err) {\n      console.log(err);\n    });\n  };\n\n  var renderFormErrors = function renderFormErrors(errors) {\n    console.log(\"renderFormErrors\", errors);\n  };\n\n  var renderCommentPicOrVideo = function renderCommentPicOrVideo(file) {\n    if (file.type.includes(\"video\")) {\n      // video logic\n      return /*#__PURE__*/React.createElement(Fragment, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Media, {\n        className: \"align-self-center\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(ReactPlayer, {\n        playing: true,\n        loop: true,\n        muted: true,\n        width: \"100%\",\n        className: \"media-body align-self-center maxed-out-video-course-profile\",\n        wrapper: \"div\",\n        url: \"\".concat(process.env.REACT_APP_ASSET_LINK, \"/\").concat(file.link),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 25\n        }\n      })));\n    } else {\n      // image logic\n      return /*#__PURE__*/React.createElement(Fragment, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Media, {\n        className: \"align-self-center\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Media, {\n        className: \"align-self-center\",\n        src: \"\".concat(process.env.REACT_APP_ASSET_LINK, \"/\").concat(file.link),\n        alt: \"\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 25\n        }\n      })));\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"section\", {\n    className: \"comment-box\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 17\n    }\n  }, \"Comment's\"), /*#__PURE__*/React.createElement(Form, {\n    onSubmit: handleSubmit(onSubmitForm, function (errors) {\n      return renderFormErrors(errors);\n    }),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"hr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Label, {\n    className: \"heavy-label-course\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 25\n    }\n  }, checkMessageMeetsCritera.label), /*#__PURE__*/React.createElement(Input, Object.assign({}, checkMessageMeetsCritera.check(setError, register, clearErrors, \"comment\"), {\n    onChange: function onChange(e) {\n      checkMessageMeetsCritera.onChange(e, \"comment\", setValue);\n      var caret = e.target.selectionStart;\n      var element = e.target;\n      window.requestAnimationFrame(function () {\n        element.selectionStart = caret;\n        element.selectionEnd = caret;\n      });\n    },\n    value: currentValues.comment,\n    name: \"comment\",\n    className: \"form-control\",\n    rows: 6,\n    type: \"textarea\",\n    placeholder: checkMessageMeetsCritera.placeholder,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 25\n    }\n  })), errors.comment ? /*#__PURE__*/React.createElement(\"span\", {\n    className: \"span-tooltip\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 43\n    }\n  }, errors.comment.message) : null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"float-right-course-comment-btn\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    className: \"btn-square-primary\",\n    color: \"primary-2x\",\n    outline: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 29\n    }\n  }, \"Leave/Post Comment!\")), /*#__PURE__*/React.createElement(\"hr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"comment-list-course-ul\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 17\n    }\n  }, typeof comments !== \"undefined\" && comments.length > 0 ? comments.map(function (comment, index) {\n    console.log(\"comment\", comment);\n    var popoverIDTarget = \"comment\".concat(index);\n    return /*#__PURE__*/React.createElement(Fragment, {\n      key: uuid(),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(Media, {\n      className: \"align-self-center\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 37\n      }\n    }, comment.posterPicOrVideo !== null ? renderCommentPicOrVideo(comment.posterPicOrVideo) : /*#__PURE__*/React.createElement(Media, {\n      className: \"align-self-center\",\n      src: require(\"../../../../../../../assets/images/blog/comment.jpg\"),\n      alt: \"\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 130\n      }\n    }), /*#__PURE__*/React.createElement(Media, {\n      body: true,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: \"4 xl-100\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 49\n      }\n    }, /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"mt-0\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 53\n      }\n    }, comment.posterName, /*#__PURE__*/React.createElement(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 94\n      }\n    }, \" \", comment.posterAccountType === \"hackers\" ? \"Hacker/Coder\" : \"Employer\")), /*#__PURE__*/React.createElement(Row, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 184\n      }\n    }, /*#__PURE__*/React.createElement(RenderEmojiLogic, {\n      comments: comments,\n      reactions: comment.reactions,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 189\n      }\n    }))), /*#__PURE__*/React.createElement(Col, {\n      md: \"8 xl-100\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 49\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      className: \"comment-social float-left float-md-right learning-comment\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 53\n      }\n    }, /*#__PURE__*/React.createElement(\"li\", {\n      id: popoverIDTarget,\n      onClick: function onClick() {\n        setPopoverState(function (prevState) {\n          return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, \"comment\".concat(index), true));\n        });\n      },\n      className: \"digits custom-digit-react-emoji\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 53\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"icofont icofont-ui-rate-add\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 100\n      }\n    }), \"React to post w/emoji\"), /*#__PURE__*/React.createElement(RenderPopoverEmojiLogic, {\n      handleRespondEmoji: handleRespondEmoji,\n      comment: comment,\n      courseData: courseData,\n      userData: userData,\n      reactions: comment.reactions,\n      setPopoverState: setPopoverState,\n      popoverState: popover,\n      targetAndPopState: popoverIDTarget,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 53\n      }\n    })))), /*#__PURE__*/React.createElement(\"p\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 45\n      }\n    }, comment.commentText)))), typeof comment.subComments !== \"undefined\" && comment.subComments.length > 0 ? comment.subComments.map(function (subcomment, idx) {\n      console.log(\"sub-comment\", subcomment);\n      return /*#__PURE__*/React.createElement(\"li\", {\n        key: idx,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 41\n        }\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 45\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 49\n        }\n      }, /*#__PURE__*/React.createElement(Media, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 53\n        }\n      }, /*#__PURE__*/React.createElement(Media, {\n        className: \"align-self-center\",\n        src: require(\"../../../../../../../assets/images/blog/9.jpg\"),\n        alt: \"\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 60\n        }\n      }), /*#__PURE__*/React.createElement(Media, {\n        body: true,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 53\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 57\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        xl: \"12\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 57\n        }\n      }, /*#__PURE__*/React.createElement(\"h6\", {\n        className: \"mt-0\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 61\n        }\n      }, \"Name goes here\", /*#__PURE__*/React.createElement(\"span\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 96\n        }\n      }, \" \", \"( Designer )\")))), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 57\n        }\n      }, \"There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isn't anything embarrassing hidden in the middle of text.\"))))));\n    }) : null);\n  }) : null)), /*#__PURE__*/React.createElement(Row, {\n    style: {\n      marginTop: \"27.5px\",\n      marginBottom: \"55px\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"centered-both-ways\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(PaginationEmployerListingHelper, {\n    itemsPerPage: itemsPerPage,\n    setItemOffset: setItemOffset,\n    loopingData: courseData.comments,\n    setPageCount: setPageCount,\n    pageCount: pageCount,\n    currentPage: currentPage,\n    setCurrentPage: setCurrentPage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 21\n    }\n  }))));\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    userData: state.auth.data\n  };\n};\n\nexport default connect(mapStateToProps, {})(CommentsIndividualCourseHelper);","map":{"version":3,"sources":["/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/src/components/dashboard/learning/educationalCoursesSeminars/viewCourses/helpers/comments/renderCommentSection.js"],"names":["React","Fragment","useState","useEffect","useRef","Row","Col","Media","Input","Label","Button","Form","axios","connect","useForm","Controller","MainHooksCourseIndividualCustomHelpers","ReactPlayer","helpers","NotificationManager","uuid","PaginationEmployerListingHelper","checkMessageMeetsCritera","itemsPerPage","RenderPopoverEmojiLogic","RenderEmojiLogic","CommentsIndividualCourseHelper","courseData","userData","mode","reValidateMode","register","handleSubmit","getValues","setValue","setError","clearErrors","errors","formState","comments","setCommentsState","popover","setPopoverState","currentPage","setCurrentPage","pageCount","setPageCount","itemOffset","setItemOffset","endOffset","Math","ceil","length","slice","newObjCount","keyyy","currentValues","onSubmitForm","data","console","log","comment","configuration","id","uniqueId","courseId","firstName","lastName","accountType","mostRecentProfilePicVideo","profilePicsVideos","post","process","env","REACT_APP_BASE_URL","then","res","message","updatedComments","shouldValidate","catch","err","handleRespondEmoji","emojiName","closePopover","targetAndPopState","commentID","course","commenttt","success","indexed","findIndex","x","copy","warning","renderFormErrors","renderCommentPicOrVideo","file","type","includes","REACT_APP_ASSET_LINK","link","label","check","e","onChange","caret","target","selectionStart","element","window","requestAnimationFrame","selectionEnd","placeholder","map","index","popoverIDTarget","posterPicOrVideo","require","posterName","posterAccountType","reactions","prevState","commentText","subComments","subcomment","idx","marginTop","marginBottom","mapStateToProps","state","auth"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect, useRef } from 'react';\nimport \"./styles.css\";\nimport { Row, Col, Media, Input, Label, Button, Form } from 'reactstrap';\nimport axios from 'axios';\nimport { connect } from \"react-redux\";\nimport { useForm, Controller } from 'react-hook-form';\nimport MainHooksCourseIndividualCustomHelpers from \"./helpers/reduxFormHelper.js\";\nimport ReactPlayer from \"react-player\";\nimport helpers from \"./helpers/helperFunctions.js\";\nimport { NotificationManager } from 'react-notifications';\nimport uuid from \"react-uuid\";\nimport PaginationEmployerListingHelper from \"../../../../../universal/pagination/paginationHelper.js\";\n\n\nconst checkMessageMeetsCritera = MainHooksCourseIndividualCustomHelpers().checkMessageMeetsCritera;\n// pagination settings and/or setup\nconst itemsPerPage = 5;\n\nconst { RenderPopoverEmojiLogic, RenderEmojiLogic } = helpers;\n\nconst CommentsIndividualCourseHelper = ({ courseData, userData }) => {\n\n    const { register, handleSubmit, getValues, setValue, setError, clearErrors, formState: { errors }} = useForm({\n        mode: \"onTouched\",\n        reValidateMode: \"onBlur\"\n    });\n\n    const [ comments, setCommentsState ] = useState([]);\n    const [ popover, setPopoverState ] = useState({}); \n    const [ currentPage, setCurrentPage ] = useState(0);\n    const [ pageCount, setPageCount ] = useState(0);\n    const [ itemOffset, setItemOffset ] = useState(0);\n\n    // render EVERY CHANGE to pagination\n    useEffect(() => {\n        const endOffset = itemOffset + itemsPerPage;\n\n        setPageCount(Math.ceil(courseData.comments.length / itemsPerPage));\n\n        setCommentsState(courseData.comments.slice(itemOffset, endOffset));\n        \n    }, [itemOffset, itemsPerPage]);\n\n    useEffect(() => {\n        // create comment popover state's\n        setPopoverState(() => {\n            const newObjCount = {};\n            const comments = courseData.comments;\n            // reassign state items in preperation for future state changes...\n            for (const keyyy in comments) {\n                newObjCount[`comment${keyyy}`] = false;\n            }\n            return newObjCount;\n        })\n    }, []);\n\n    const currentValues = getValues();\n\n    const onSubmitForm = (data) => {\n        console.log(\"onSubmitForm submitted form properly...!:\", data);\n\n        const { comment } = data;\n\n        const configuration = {\n            id: userData.uniqueId,\n            courseId: courseData.id,\n            comment,\n            firstName: userData.firstName,\n            lastName: userData.lastName,\n            accountType: userData.accountType,\n            mostRecentProfilePicVideo: typeof userData.profilePicsVideos !== \"undefined\" && userData.profilePicsVideos.length > 0 ? userData.profilePicsVideos[userData.profilePicsVideos.length - 1] : null\n        }\n\n        axios.post(`${process.env.REACT_APP_BASE_URL}/post/comment/course/individual/listing`, configuration).then((res) => {\n            if (res.data.message === \"Successfully posted comment!\") {\n                console.log(res.data);\n\n                const { updatedComments } = res.data;\n\n                setValue(\"comment\", \"\", { shouldValidate: false });\n\n                setCommentsState(updatedComments);\n\n            } else {\n                console.log(\"Err\", res.data);\n            }\n        }).catch((err) => {\n            console.log(err);\n        })\n    }\n    const handleRespondEmoji = (emojiName, comment, closePopover, targetAndPopState) => {\n        console.log(\"emojiName\", emojiName);\n\n        const configuration = {\n            emojiName,\n            id: userData.uniqueId,\n            courseId: courseData.id,\n            commentID: comment.id,\n            comment\n        };\n\n        axios.post(`${process.env.REACT_APP_BASE_URL}/respond/emoji/comment/course/learning`, configuration).then((res) => {\n            if (res.data.message === \"Successfully reacted to comment!\") {\n                console.log(res.data);\n\n                const { course, commenttt } = res.data;\n\n                NotificationManager.success(\"Successfully REACTED to the selected comment, Your response is now live!\", \"Successfully reacted to comment!\", 4500);\n\n                const indexed = comments.findIndex(x => x.id === commenttt.id);\n\n                const copy = [...comments];\n                copy[indexed] = commenttt;\n                \n                setCommentsState(copy);\n\n                closePopover(targetAndPopState);\n            } else if (res.data.message === \"You've already reacted to this comment! Since you've previously reacted, we're removing your existing response so you can update it!\") {\n                const { course, commenttt } = res.data;\n\n                NotificationManager.warning(res.data.message, \"Successfully redacted your existing response!\", 4500);\n\n                const indexed = comments.findIndex(x => x.id === commenttt.id);\n\n                const copy = [...comments];\n                copy[indexed] = commenttt;\n                \n                setCommentsState(copy);\n\n                closePopover(targetAndPopState);\n            } else {\n                console.log(\"Err\", res.data);\n            }\n        }).catch((err) => {\n            console.log(err);\n        })\n    }\n    const renderFormErrors = (errors) => {\n        console.log(\"renderFormErrors\", errors);\n    }\n    const renderCommentPicOrVideo = (file) => {\n        if (file.type.includes(\"video\")) {\n            // video logic\n            return (\n                <Fragment>\n                    <Media className=\"align-self-center\">\n                        <ReactPlayer playing={true} loop={true} muted={true} width={\"100%\"} className={\"media-body align-self-center maxed-out-video-course-profile\"} wrapper={\"div\"} url={`${process.env.REACT_APP_ASSET_LINK}/${file.link}`} />\n                    </Media> \n                </Fragment>\n            );\n        } else {\n            // image logic\n            return (\n                <Fragment>\n                    <Media className=\"align-self-center\">\n                        <Media className=\"align-self-center\" src={`${process.env.REACT_APP_ASSET_LINK}/${file.link}`} alt=\"\"/>\n                    </Media>\n                </Fragment>\n            );\n        }  \n    }\n    return (\n        <Fragment>\n            <section className=\"comment-box\">\n                <h4>Comment's</h4>\n                <Form onSubmit={handleSubmit(onSubmitForm, (errors) => renderFormErrors(errors))}>\n                    <hr/>\n                        <Label className={\"heavy-label-course\"}>{checkMessageMeetsCritera.label}</Label>\n                        <Input {...checkMessageMeetsCritera.check(setError, register, clearErrors, \"comment\")} onChange={(e) => {\n\n                            checkMessageMeetsCritera.onChange(e, \"comment\", setValue);\n\n                            const caret = e.target.selectionStart;\n                            const element = e.target;\n                            window.requestAnimationFrame(() => {\n                                element.selectionStart = caret\n                                element.selectionEnd = caret\n                            })\n                        }} value={currentValues.comment} name={\"comment\"} className={\"form-control\"} rows={6} type={\"textarea\"} placeholder={checkMessageMeetsCritera.placeholder} />\n                        {errors.comment ? <span className=\"span-tooltip\">{errors.comment.message}</span> : null}\n                        <div className={\"float-right-course-comment-btn\"}>\n                            <Button type={\"submit\"} className={\"btn-square-primary\"} color={\"primary-2x\"} outline>Leave/Post Comment!</Button>\n                        </div>\n                    <hr />\n                </Form>\n                <ul className={\"comment-list-course-ul\"}>\n                    {typeof comments !== \"undefined\" && comments.length > 0 ? comments.map((comment, index) => {\n                        console.log(\"comment\", comment);\n\n                        const popoverIDTarget = `comment${index}`;\n                        return (\n                            <Fragment key={uuid()}>\n                                <li>\n                                    <Media className=\"align-self-center\">\n                                        {comment.posterPicOrVideo !== null ? renderCommentPicOrVideo(comment.posterPicOrVideo) : <Media className=\"align-self-center\" src={require(\"../../../../../../../assets/images/blog/comment.jpg\")} alt=\"\"/>}\n                                        <Media body>\n                                            <Row>\n                                                <Col md=\"4 xl-100\">\n                                                    <h6 className=\"mt-0\">{comment.posterName}<span> {comment.posterAccountType === \"hackers\" ? \"Hacker/Coder\" : \"Employer\"}</span></h6><Row><RenderEmojiLogic comments={comments} reactions={comment.reactions} /></Row>\n                                                </Col>\n                                                <Col md=\"8 xl-100\">\n                                                    <ul className=\"comment-social float-left float-md-right learning-comment\">\n                                                    {/* <li className=\"digits\"><i className=\"icofont icofont-thumbs-up\"></i>{\"02 Hits\"}</li> */}\n                                                    <li id={popoverIDTarget} onClick={() => {\n                                                        setPopoverState(prevState => {\n                                                            return {\n                                                                ...prevState,\n                                                                [`comment${index}`]: true\n                                                            }\n                                                        });\n                                                    }} className=\"digits custom-digit-react-emoji\"><i className=\"icofont icofont-ui-rate-add\"></i>{\"React to post w/emoji\"}</li>\n                                                    <RenderPopoverEmojiLogic handleRespondEmoji={handleRespondEmoji} comment={comment} courseData={courseData} userData={userData} reactions={comment.reactions} setPopoverState={setPopoverState} popoverState={popover} targetAndPopState={popoverIDTarget} />\n                                                    </ul>\n                                                </Col>\n                                            </Row>\n                                            <p>{comment.commentText}</p>\n                                        </Media>\n                                    </Media>\n                                </li>\n                                {typeof comment.subComments !== \"undefined\" && comment.subComments.length > 0 ? comment.subComments.map((subcomment, idx) => {\n                                    console.log(\"sub-comment\", subcomment);\n                                    return (\n                                        <li key={idx}>\n                                            <ul>\n                                                <li>\n                                                    <Media><Media className=\"align-self-center\" src={require(\"../../../../../../../assets/images/blog/9.jpg\")} alt=\"\"/>\n                                                    <Media body>\n                                                        <Row>\n                                                        <Col xl=\"12\">\n                                                            <h6 className=\"mt-0\">Name goes here<span> {\"( Designer )\"}</span></h6>\n                                                        </Col>\n                                                        </Row>\n                                                        <p>{\"There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isn't anything embarrassing hidden in the middle of text.\"}</p>\n                                                    </Media>\n                                                    </Media>\n                                                </li>\n                                            </ul>\n                                        </li>\n                                    );\n                                }) : null}\n                            </Fragment>\n                        );\n                    }) : null}\n                </ul>\n            </section>\n            <Row style={{ marginTop: \"27.5px\", marginBottom: \"55px\" }}>\n                <div className=\"centered-both-ways\">\n                    <PaginationEmployerListingHelper itemsPerPage={itemsPerPage} setItemOffset={setItemOffset} loopingData={courseData.comments} setPageCount={setPageCount} pageCount={pageCount} currentPage={currentPage} setCurrentPage={setCurrentPage} />\n                </div>\n            </Row>\n        </Fragment>\n    );\n}\nconst mapStateToProps = (state) => {\n    return {\n        userData: state.auth.data\n    }\n}\nexport default connect(mapStateToProps, {  })(CommentsIndividualCourseHelper);\n"]},"metadata":{},"sourceType":"module"}