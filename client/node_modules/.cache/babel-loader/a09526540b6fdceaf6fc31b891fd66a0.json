{"ast":null,"code":"import CryptoJS from 'crypto-js';\nconst algorithm = process.env.REACT_APP_CRYPTO_ALG;\nconst secretKey = process.env.REACT_APP_CRYPTO_SECRET;\nconst iv = CryptoJS.randomBytes(16);\n\nconst encrypt = text => {\n  const cipher = CryptoJS.createCipheriv(algorithm, secretKey, iv);\n  const encrypted = Buffer.concat([cipher.update(text), cipher.final()]);\n  return {\n    iv: iv.toString('hex'),\n    content: encrypted.toString('hex')\n  };\n};\n\nconst decrypt = hash => {\n  const decipher = CryptoJS.createDecipheriv(algorithm, secretKey, Buffer.from(hash.iv, 'hex'));\n  const decrpyted = Buffer.concat([decipher.update(Buffer.from(hash.content, 'hex')), decipher.final()]);\n  return decrpyted.toString();\n};\n\nexport default {\n  encrypt,\n  decrypt\n};","map":{"version":3,"sources":["/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/src/utils/crypto.js"],"names":["CryptoJS","algorithm","process","env","REACT_APP_CRYPTO_ALG","secretKey","REACT_APP_CRYPTO_SECRET","iv","randomBytes","encrypt","text","cipher","createCipheriv","encrypted","Buffer","concat","update","final","toString","content","decrypt","hash","decipher","createDecipheriv","from","decrpyted"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,WAArB;AACA,MAAMC,SAAS,GAAGC,OAAO,CAACC,GAAR,CAAYC,oBAA9B;AACA,MAAMC,SAAS,GAAGH,OAAO,CAACC,GAAR,CAAYG,uBAA9B;AACA,MAAMC,EAAE,GAAGP,QAAQ,CAACQ,WAAT,CAAqB,EAArB,CAAX;;AAEA,MAAMC,OAAO,GAAIC,IAAD,IAAU;AAEtB,QAAMC,MAAM,GAAGX,QAAQ,CAACY,cAAT,CAAwBX,SAAxB,EAAmCI,SAAnC,EAA8CE,EAA9C,CAAf;AAEA,QAAMM,SAAS,GAAGC,MAAM,CAACC,MAAP,CAAc,CAACJ,MAAM,CAACK,MAAP,CAAcN,IAAd,CAAD,EAAsBC,MAAM,CAACM,KAAP,EAAtB,CAAd,CAAlB;AAEA,SAAO;AACHV,IAAAA,EAAE,EAAEA,EAAE,CAACW,QAAH,CAAY,KAAZ,CADD;AAEHC,IAAAA,OAAO,EAAEN,SAAS,CAACK,QAAV,CAAmB,KAAnB;AAFN,GAAP;AAIH,CAVD;;AAYA,MAAME,OAAO,GAAIC,IAAD,IAAU;AAEtB,QAAMC,QAAQ,GAAGtB,QAAQ,CAACuB,gBAAT,CAA0BtB,SAA1B,EAAqCI,SAArC,EAAgDS,MAAM,CAACU,IAAP,CAAYH,IAAI,CAACd,EAAjB,EAAqB,KAArB,CAAhD,CAAjB;AAEA,QAAMkB,SAAS,GAAGX,MAAM,CAACC,MAAP,CAAc,CAACO,QAAQ,CAACN,MAAT,CAAgBF,MAAM,CAACU,IAAP,CAAYH,IAAI,CAACF,OAAjB,EAA0B,KAA1B,CAAhB,CAAD,EAAoDG,QAAQ,CAACL,KAAT,EAApD,CAAd,CAAlB;AAEA,SAAOQ,SAAS,CAACP,QAAV,EAAP;AACH,CAPD;;AASA,eAAe;AACXT,EAAAA,OADW;AAEXW,EAAAA;AAFW,CAAf","sourcesContent":["import CryptoJS from 'crypto-js';\nconst algorithm = process.env.REACT_APP_CRYPTO_ALG;\nconst secretKey = process.env.REACT_APP_CRYPTO_SECRET;\nconst iv = CryptoJS.randomBytes(16);\n\nconst encrypt = (text) => {\n\n    const cipher = CryptoJS.createCipheriv(algorithm, secretKey, iv);\n\n    const encrypted = Buffer.concat([cipher.update(text), cipher.final()]);\n\n    return {\n        iv: iv.toString('hex'),\n        content: encrypted.toString('hex')\n    };\n};\n\nconst decrypt = (hash) => {\n\n    const decipher = CryptoJS.createDecipheriv(algorithm, secretKey, Buffer.from(hash.iv, 'hex'));\n\n    const decrpyted = Buffer.concat([decipher.update(Buffer.from(hash.content, 'hex')), decipher.final()]);\n\n    return decrpyted.toString();\n};\n\nexport default {\n    encrypt,\n    decrypt\n}"]},"metadata":{},"sourceType":"module"}