{"ast":null,"code":"import React,{Fragment,useState,useEffect,useRef}from'react';import\"../../styles.css\";import{Row,Col,Media}from'reactstrap';import axios from'axios';import ReactPlayer from\"react-player\";import helpers from\"./otherHelpers/helperFunctions.js\";import{NotificationManager}from'react-notifications';import uuid from\"react-uuid\";import PaginationEmployerListingHelper from\"../../../../../../../universal/pagination/paginationHelper.js\";const{RenderPopoverEmojiLogic,RenderEmojiLogic}=helpers;// pagination settings and/or setup\nconst itemsPerPage=5;const renderCommentPicOrVideo=(file,id)=>{if(file!==null){if(file.type.includes(\"video\")){// video logic\nreturn/*#__PURE__*/React.createElement(Fragment,{key:id},/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\"},/*#__PURE__*/React.createElement(ReactPlayer,{playing:true,loop:true,muted:true,width:\"100%\",className:\"media-body align-self-center maxed-out-video-course-profile\",wrapper:\"div\",url:\"\".concat(process.env.REACT_APP_ASSET_LINK,\"/\").concat(file.link)})));}else{// image logic\nreturn/*#__PURE__*/React.createElement(Fragment,{key:id},/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\"},/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\",src:\"\".concat(process.env.REACT_APP_ASSET_LINK,\"/\").concat(file.link),alt:\"\"})));}}else{return/*#__PURE__*/React.createElement(Media,{key:id,className:\"align-self-center\",src:process.env.REACT_APP_PLACEHOLDER_IMAGE,alt:\"\"});}};// main function starts\nconst CommentsIndividualPostReturnCommentsHelper=_ref=>{let{comments,setCommentsState,userData,data}=_ref;// state initialization\nconst[popover,setPopoverState]=useState({});const[currentPage,setCurrentPage]=useState(0);const[pageCount,setPageCount]=useState(0);const[itemOffset,setItemOffset]=useState(0);const[allComments,setAllCommentsState]=useState([]);const[localComments,setLocalComments]=useState([]);// render EVERY CHANGE to pagination\nuseEffect(()=>{const endOffset=itemOffset+itemsPerPage;setAllCommentsState(data.comments);console.log(\"Booyahhhhh.\",itemOffset,endOffset);setPageCount(Math.ceil(data.comments.length/itemsPerPage));setLocalComments(data.comments.slice(itemOffset,endOffset));},[itemOffset,itemsPerPage]);useEffect(()=>{console.log(\"currentPage CHANGED...\");const endOffset=itemOffset+itemsPerPage;setLocalComments(comments.slice(itemOffset,endOffset));},[currentPage]);console.log(\"all comment variations...:\",allComments,data.comments,comments);// render ONLY ONCE\nuseEffect(()=>{setPopoverState(()=>{const newObjCount={};const comments=data.comments;// reassign state items in preperation for future state changes...\nfor(const keyyy in comments){newObjCount[\"comment\".concat(keyyy)]=false;}return newObjCount;});},[]);const handleRespondEmoji=(emojiName,comment,closePopover,targetAndPopState)=>{console.log(\"emojiName\",emojiName);const configuration={emojiName,id:userData.uniqueId,listingId:data.uniqueId,commentID:comment.id,comment};axios.post(\"\".concat(process.env.REACT_APP_BASE_URL,\"/\"),configuration).then(res=>{if(res.data.message===\"Successfully reacted to comment!\"){console.log(res.data);const{listing,commenttt}=res.data;NotificationManager.success(\"Successfully REACTED to the selected comment, Your response is now live!\",\"Successfully reacted to comment!\",4500);const indexed=comments.findIndex(x=>x.id===commenttt.id);const copy=[...comments];copy[indexed]=commenttt;setLocalComments(copy);closePopover(targetAndPopState);}else if(res.data.message===\"You've already reacted to this comment! Since you've previously reacted, we're removing your existing response so you can update it!\"){const{listing,commenttt}=res.data;NotificationManager.warning(res.data.message,\"Successfully redacted your existing response!\",4500);const indexed=comments.findIndex(x=>x.id===commenttt.id);const copy=[...comments];copy[indexed]=commenttt;setLocalComments(copy);closePopover(targetAndPopState);}else{console.log(\"Err\",res.data);}}).catch(err=>{console.log(err);});};console.log(\"LAST COMPONENT COMMENT.LENGTH...:\",comments.length);return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"section\",{className:\"comment-box\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Comment's\"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"ul\",{className:\"comment-list-course-ul\"},typeof localComments!==\"undefined\"&&localComments.length>0?localComments.map((comment,index)=>{const popoverIDTarget=\"comment\".concat(index);return/*#__PURE__*/React.createElement(Fragment,{key:\"\".concat(comment.uniqueId,\"-\").concat(comments.length,\"-\").concat(index)},/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\"},renderCommentPicOrVideo(comment.posterPicOrVideo,index),/*#__PURE__*/React.createElement(Media,{body:true},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"4 xl-100\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"mt-0\"},comment.posterName,/*#__PURE__*/React.createElement(\"span\",null,\" \",comment.posterAccountType===\"hackers\"?\"Hacker/Coder\":\"Employer\")),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(RenderEmojiLogic,{comments:comments,reactions:comment.reactions}))),/*#__PURE__*/React.createElement(Col,{md:\"8 xl-100\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"comment-social float-left float-md-right learning-comment\"},/*#__PURE__*/React.createElement(\"li\",{id:popoverIDTarget,onClick:()=>{setPopoverState(prevState=>{return{...prevState,[\"comment\".concat(index)]:true};});},className:\"digits custom-digit-react-emoji\"},/*#__PURE__*/React.createElement(\"i\",{className:\"icofont icofont-ui-rate-add\"}),\"React to post w/emoji\"),/*#__PURE__*/React.createElement(RenderPopoverEmojiLogic,{handleRespondEmoji:handleRespondEmoji,userData:userData,comment:comment,data:data,userData:userData,reactions:comment.reactions,setPopoverState:setPopoverState,popoverState:popover,targetAndPopState:popoverIDTarget})))),/*#__PURE__*/React.createElement(\"p\",null,comment.commentText)))),typeof comment.subComments!==\"undefined\"&&comment.subComments.length>0?comment.subComments.map((subcomment,idx)=>{console.log(\"sub-comment\",subcomment);return/*#__PURE__*/React.createElement(\"li\",{key:idx},/*#__PURE__*/React.createElement(\"ul\",null,/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(Media,null,/*#__PURE__*/React.createElement(Media,{className:\"align-self-center\",src:require(\"../../../../../../../../../assets/images/blog/9.jpg\"),alt:\"\"}),/*#__PURE__*/React.createElement(Media,{body:true},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{xl:\"12\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"mt-0\"},\"Name goes here\",/*#__PURE__*/React.createElement(\"span\",null,\" \",\"( Designer )\")))),/*#__PURE__*/React.createElement(\"p\",null,\"There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isn't anything embarrassing hidden in the middle of text.\"))))));}):null);}):null)),/*#__PURE__*/React.createElement(Row,{style:{marginTop:\"27.5px\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"centered-both-ways\"},/*#__PURE__*/React.createElement(PaginationEmployerListingHelper,{itemsPerPage:itemsPerPage,setItemOffset:setItemOffset,loopingData:allComments,setPageCount:setPageCount,pageCount:pageCount,currentPage:currentPage,setCurrentPage:setCurrentPage}))));};export default CommentsIndividualPostReturnCommentsHelper;","map":{"version":3,"sources":["/home/kali/Documents/cybersecurity-bounty-hunting-platform/client/src/components/dashboard/people/hackers/individualProfile/helpers/viewPostFileContents/helpers/renderComments/commentsHelper.js"],"names":["React","Fragment","useState","useEffect","useRef","Row","Col","Media","axios","ReactPlayer","helpers","NotificationManager","uuid","PaginationEmployerListingHelper","RenderPopoverEmojiLogic","RenderEmojiLogic","itemsPerPage","renderCommentPicOrVideo","file","id","type","includes","process","env","REACT_APP_ASSET_LINK","link","REACT_APP_PLACEHOLDER_IMAGE","CommentsIndividualPostReturnCommentsHelper","comments","setCommentsState","userData","data","popover","setPopoverState","currentPage","setCurrentPage","pageCount","setPageCount","itemOffset","setItemOffset","allComments","setAllCommentsState","localComments","setLocalComments","endOffset","console","log","Math","ceil","length","slice","newObjCount","keyyy","handleRespondEmoji","emojiName","comment","closePopover","targetAndPopState","configuration","uniqueId","listingId","commentID","post","REACT_APP_BASE_URL","then","res","message","listing","commenttt","success","indexed","findIndex","x","copy","warning","catch","err","map","index","popoverIDTarget","posterPicOrVideo","posterName","posterAccountType","reactions","prevState","commentText","subComments","subcomment","idx","require","marginTop"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useEffect, useRef } from 'react';\nimport \"../../styles.css\";\nimport { Row, Col, Media } from 'reactstrap';\nimport axios from 'axios';\nimport ReactPlayer from \"react-player\";\nimport helpers from \"./otherHelpers/helperFunctions.js\";\nimport { NotificationManager } from 'react-notifications';\nimport uuid from \"react-uuid\";\nimport PaginationEmployerListingHelper from \"../../../../../../../universal/pagination/paginationHelper.js\";\n\nconst { RenderPopoverEmojiLogic, RenderEmojiLogic } = helpers;\n\n// pagination settings and/or setup\nconst itemsPerPage = 5;\n\nconst renderCommentPicOrVideo = (file, id) => {\n    if (file !== null) {\n        if (file.type.includes(\"video\")) {\n            // video logic\n            return (\n                <Fragment key={id}>\n                    <Media className=\"align-self-center\">\n                        <ReactPlayer playing={true} loop={true} muted={true} width={\"100%\"} className={\"media-body align-self-center maxed-out-video-course-profile\"} wrapper={\"div\"} url={`${process.env.REACT_APP_ASSET_LINK}/${file.link}`} />\n                    </Media> \n                </Fragment>\n            );\n        } else {\n            // image logic\n            return (\n                <Fragment key={id}>\n                    <Media className=\"align-self-center\">\n                        <Media className=\"align-self-center\" src={`${process.env.REACT_APP_ASSET_LINK}/${file.link}`} alt=\"\"/>\n                    </Media>\n                </Fragment>\n            );\n        }  \n    } else {\n        return <Media key={id} className=\"align-self-center\" src={process.env.REACT_APP_PLACEHOLDER_IMAGE} alt=\"\"/>;\n    }\n}\n\n// main function starts\nconst CommentsIndividualPostReturnCommentsHelper = ({ comments, setCommentsState, userData, data }) => {\n    // state initialization\n    const [ popover, setPopoverState ] = useState({}); \n    const [ currentPage, setCurrentPage ] = useState(0);\n    const [ pageCount, setPageCount ] = useState(0);\n    const [ itemOffset, setItemOffset ] = useState(0);\n    const [ allComments, setAllCommentsState ] = useState([]);\n    const [ localComments, setLocalComments ] = useState([]);\n    \n    // render EVERY CHANGE to pagination\n    useEffect(() => {\n        const endOffset = itemOffset + itemsPerPage;\n\n        setAllCommentsState(data.comments);\n\n        console.log(\"Booyahhhhh.\", itemOffset, endOffset);\n\n        setPageCount(Math.ceil(data.comments.length / itemsPerPage));\n\n        setLocalComments(data.comments.slice(itemOffset, endOffset));\n        \n    }, [itemOffset, itemsPerPage]);\n\n    useEffect( () => {\n        console.log(\"currentPage CHANGED...\");\n\n        const endOffset = itemOffset + itemsPerPage;\n\n        setLocalComments(comments.slice(itemOffset, endOffset));\n    }, [currentPage] );\n    \n    console.log(\"all comment variations...:\", allComments, data.comments, comments);\n\n    // render ONLY ONCE\n    useEffect(() => {\n        setPopoverState(() => {\n            const newObjCount = {};\n            const comments = data.comments;\n            // reassign state items in preperation for future state changes...\n            for (const keyyy in comments) {\n                newObjCount[`comment${keyyy}`] = false;\n            }\n            return newObjCount;\n        })\n    }, []);\n    const handleRespondEmoji = (emojiName, comment, closePopover, targetAndPopState) => {\n        console.log(\"emojiName\", emojiName);\n\n        const configuration = {\n            emojiName,\n            id: userData.uniqueId,\n            listingId: data.uniqueId,\n            commentID: comment.id,\n            comment\n        };\n\n        axios.post(`${process.env.REACT_APP_BASE_URL}/`, configuration).then((res) => {\n            if (res.data.message === \"Successfully reacted to comment!\") {\n                console.log(res.data);\n\n                const { listing, commenttt } = res.data;\n\n                NotificationManager.success(\"Successfully REACTED to the selected comment, Your response is now live!\", \"Successfully reacted to comment!\", 4500);\n\n                const indexed = comments.findIndex(x => x.id === commenttt.id);\n\n                const copy = [...comments];\n                copy[indexed] = commenttt;\n                \n                setLocalComments(copy);\n\n                closePopover(targetAndPopState);\n            } else if (res.data.message === \"You've already reacted to this comment! Since you've previously reacted, we're removing your existing response so you can update it!\") {\n                const { listing, commenttt } = res.data;\n\n                NotificationManager.warning(res.data.message, \"Successfully redacted your existing response!\", 4500);\n\n                const indexed = comments.findIndex(x => x.id === commenttt.id);\n\n                const copy = [...comments];\n                copy[indexed] = commenttt;\n                \n                setLocalComments(copy);\n\n                closePopover(targetAndPopState);\n            } else {\n                console.log(\"Err\", res.data);\n            }\n        }).catch((err) => {\n            console.log(err);\n        })\n    }\n    console.log(\"LAST COMPONENT COMMENT.LENGTH...:\", comments.length);\n    return (\n        <Fragment>\n            <section className=\"comment-box\">\n                <h4>Comment's</h4>\n                <hr />\n                <ul className={\"comment-list-course-ul\"}>\n                    {typeof localComments !== \"undefined\" && localComments.length > 0 ? localComments.map((comment, index) => {\n                        const popoverIDTarget = `comment${index}`;\n                        return (\n                            <Fragment key={`${comment.uniqueId}-${comments.length}-${index}`}>\n                                <li>\n                                    <Media className=\"align-self-center\">\n                                        {renderCommentPicOrVideo(comment.posterPicOrVideo, index)}\n                                        <Media body>\n                                            <Row>\n                                                <Col md=\"4 xl-100\">\n                                                    <h6 className=\"mt-0\">{comment.posterName}<span> {comment.posterAccountType === \"hackers\" ? \"Hacker/Coder\" : \"Employer\"}</span></h6><Row><RenderEmojiLogic comments={comments} reactions={comment.reactions} /></Row>\n                                                </Col>\n                                                <Col md=\"8 xl-100\">\n                                                    <ul className=\"comment-social float-left float-md-right learning-comment\">\n                                                    {/* <li className=\"digits\"><i className=\"icofont icofont-thumbs-up\"></i>{\"02 Hits\"}</li> */}\n                                                    <li id={popoverIDTarget} onClick={() => {\n                                                        setPopoverState(prevState => {\n                                                            return {\n                                                                ...prevState,\n                                                                [`comment${index}`]: true\n                                                            }\n                                                        });\n                                                    }} className=\"digits custom-digit-react-emoji\"><i className=\"icofont icofont-ui-rate-add\"></i>{\"React to post w/emoji\"}</li>\n                                                    <RenderPopoverEmojiLogic handleRespondEmoji={handleRespondEmoji} userData={userData} comment={comment} data={data} userData={userData} reactions={comment.reactions} setPopoverState={setPopoverState} popoverState={popover} targetAndPopState={popoverIDTarget} />\n                                                    </ul>\n                                                </Col>\n                                            </Row>\n                                            <p>{comment.commentText}</p>\n                                        </Media>\n                                    </Media>\n                                </li>\n                                {typeof comment.subComments !== \"undefined\" && comment.subComments.length > 0 ? comment.subComments.map((subcomment, idx) => {\n                                    console.log(\"sub-comment\", subcomment);\n                                    return (\n                                        <li key={idx}>\n                                            <ul>\n                                                <li>\n                                                    <Media><Media className=\"align-self-center\" src={require(\"../../../../../../../../../assets/images/blog/9.jpg\")} alt=\"\"/>\n                                                    <Media body>\n                                                        <Row>\n                                                        <Col xl=\"12\">\n                                                            <h6 className=\"mt-0\">Name goes here<span> {\"( Designer )\"}</span></h6>\n                                                        </Col>\n                                                        </Row>\n                                                        <p>{\"There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isn't anything embarrassing hidden in the middle of text.\"}</p>\n                                                    </Media>\n                                                    </Media>\n                                                </li>\n                                            </ul>\n                                        </li>\n                                    );\n                                }) : null}\n                            </Fragment>\n                        );\n                    }) : null}\n                </ul>\n            </section>\n            <Row style={{ marginTop: \"27.5px\" }}>\n                <div className=\"centered-both-ways\">\n                    <PaginationEmployerListingHelper itemsPerPage={itemsPerPage} setItemOffset={setItemOffset} loopingData={allComments} setPageCount={setPageCount} pageCount={pageCount} currentPage={currentPage} setCurrentPage={setCurrentPage} />\n                </div>\n            </Row>\n        </Fragment>\n    );\n}\nexport default CommentsIndividualPostReturnCommentsHelper;"]},"metadata":{},"sourceType":"module"}