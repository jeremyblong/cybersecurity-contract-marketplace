{"ast":null,"code":"/* eslint callback-return:0 */\n'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar MediaSignaling = require('./mediasignaling');\n\nvar messageId = 1;\n\nvar PublisherHintsSignaling =\n/** @class */\nfunction (_super) {\n  __extends(PublisherHintsSignaling, _super);\n  /**\n   * Construct a {@link RenderHintsSignaling}.\n   */\n\n\n  function PublisherHintsSignaling(getReceiver, options) {\n    var _this = _super.call(this, getReceiver, 'publisher_hints', options) || this;\n\n    _this.on('ready', function (transport) {\n      _this._log.debug('publisher_hints transport ready:', transport);\n\n      transport.on('message', function (message) {\n        _this._log.debug('Incoming: ', message);\n\n        switch (message.type) {\n          case 'publisher_hints':\n            if (message.publisher && message.publisher.hints && message.publisher.id) {\n              _this._processPublisherHints(message.publisher.hints, message.publisher.id);\n            }\n\n            break;\n\n          default:\n            _this._log.warn('Unknown message type: ', message.type);\n\n            break;\n        }\n      });\n    });\n\n    return _this;\n  }\n\n  PublisherHintsSignaling.prototype.sendTrackReplaced = function (_a) {\n    var trackSid = _a.trackSid;\n\n    if (!this._transport) {\n      return;\n    }\n\n    var payLoad = {\n      type: 'client_reset',\n      track: trackSid,\n      id: messageId++\n    };\n\n    this._log.debug('Outgoing: ', payLoad);\n\n    this._transport.publish(payLoad);\n  };\n\n  PublisherHintsSignaling.prototype.sendHintResponse = function (_a) {\n    var id = _a.id,\n        hints = _a.hints;\n\n    if (!this._transport) {\n      return;\n    }\n\n    var payLoad = {\n      type: 'publisher_hints',\n      id: id,\n      hints: hints\n    };\n\n    this._log.debug('Outgoing: ', payLoad);\n\n    this._transport.publish(payLoad);\n  };\n  /**\n   * @private\n   */\n\n\n  PublisherHintsSignaling.prototype._processPublisherHints = function (hints, id) {\n    try {\n      this.emit('updated', hints, id);\n    } catch (ex) {\n      this._log.error('error processing hints:', ex);\n    }\n  };\n\n  return PublisherHintsSignaling;\n}(MediaSignaling);\n\nmodule.exports = PublisherHintsSignaling;","map":{"version":3,"sources":["../../../lib/signaling/v2/publisherhintsignaling.js"],"names":[],"mappings":"AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAM,cAAc,GAAG,OAAO,CAAC,kBAAD,CAA9B;;AAEA,IAAI,SAAS,GAAG,CAAhB;;AACA,IAAA,uBAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAsC,EAAA,SAAA,CAAA,uBAAA,EAAA,MAAA,CAAA;AACpC;;AAEG;;;AACH,WAAA,uBAAA,CAAY,WAAZ,EAAyB,OAAzB,EAAgC;AAAhC,QAAA,KAAA,GACE,MAAA,CAAA,IAAA,CAAA,IAAA,EAAM,WAAN,EAAmB,iBAAnB,EAAsC,OAAtC,KAA8C,IADhD;;AAEE,IAAA,KAAI,CAAC,EAAL,CAAQ,OAAR,EAAiB,UAAA,SAAA,EAAS;AACxB,MAAA,KAAI,CAAC,IAAL,CAAU,KAAV,CAAgB,kCAAhB,EAAoD,SAApD;;AACA,MAAA,SAAS,CAAC,EAAV,CAAa,SAAb,EAAwB,UAAA,OAAA,EAAO;AAC7B,QAAA,KAAI,CAAC,IAAL,CAAU,KAAV,CAAgB,YAAhB,EAA8B,OAA9B;;AACA,gBAAQ,OAAO,CAAC,IAAhB;AACE,eAAK,iBAAL;AACE,gBAAI,OAAO,CAAC,SAAR,IAAqB,OAAO,CAAC,SAAR,CAAkB,KAAvC,IAAgD,OAAO,CAAC,SAAR,CAAkB,EAAtE,EAA0E;AACxE,cAAA,KAAI,CAAC,sBAAL,CAA4B,OAAO,CAAC,SAAR,CAAkB,KAA9C,EAAqD,OAAO,CAAC,SAAR,CAAkB,EAAvE;AACD;;AACD;;AACF;AACE,YAAA,KAAI,CAAC,IAAL,CAAU,IAAV,CAAe,wBAAf,EAAyC,OAAO,CAAC,IAAjD;;AACA;AARJ;AAUD,OAZD;AAaD,KAfD;;;AAgBD;;AAED,EAAA,uBAAA,CAAA,SAAA,CAAA,iBAAA,GAAA,UAAkB,EAAlB,EAA8B;QAAV,QAAQ,GAAA,EAAA,CAAA,Q;;AAC1B,QAAI,CAAC,KAAK,UAAV,EAAsB;AACpB;AACD;;AAED,QAAM,OAAO,GAAG;AACd,MAAA,IAAI,EAAE,cADQ;AAEd,MAAA,KAAK,EAAE,QAFO;AAGd,MAAA,EAAE,EAAE,SAAS;AAHC,KAAhB;;AAKA,SAAK,IAAL,CAAU,KAAV,CAAgB,YAAhB,EAA8B,OAA9B;;AACA,SAAK,UAAL,CAAgB,OAAhB,CAAwB,OAAxB;AACD,GAZD;;AAcA,EAAA,uBAAA,CAAA,SAAA,CAAA,gBAAA,GAAA,UAAiB,EAAjB,EAA8B;QAAX,EAAE,GAAA,EAAA,CAAA,E;QAAE,KAAK,GAAA,EAAA,CAAA,K;;AAC1B,QAAI,CAAC,KAAK,UAAV,EAAsB;AACpB;AACD;;AACD,QAAM,OAAO,GAAG;AACd,MAAA,IAAI,EAAE,iBADQ;AAEd,MAAA,EAAE,EAAA,EAFY;AAGd,MAAA,KAAK,EAAA;AAHS,KAAhB;;AAKA,SAAK,IAAL,CAAU,KAAV,CAAgB,YAAhB,EAA8B,OAA9B;;AACA,SAAK,UAAL,CAAgB,OAAhB,CAAwB,OAAxB;AACD,GAXD;AAaA;;AAEG;;;AACH,EAAA,uBAAA,CAAA,SAAA,CAAA,sBAAA,GAAA,UAAuB,KAAvB,EAA8B,EAA9B,EAAgC;AAC9B,QAAI;AACF,WAAK,IAAL,CAAU,SAAV,EAAqB,KAArB,EAA4B,EAA5B;AACD,KAFD,CAEE,OAAO,EAAP,EAAW;AACX,WAAK,IAAL,CAAU,KAAV,CAAgB,yBAAhB,EAA2C,EAA3C;AACD;AACF,GAND;;AAOF,SAAA,uBAAA;AAAC,CA7DD,CAAsC,cAAtC,CAAA;;AAgEA,MAAM,CAAC,OAAP,GAAiB,uBAAjB","sourceRoot":"","sourcesContent":["/* eslint callback-return:0 */\n'use strict';\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar MediaSignaling = require('./mediasignaling');\nvar messageId = 1;\nvar PublisherHintsSignaling = /** @class */ (function (_super) {\n    __extends(PublisherHintsSignaling, _super);\n    /**\n     * Construct a {@link RenderHintsSignaling}.\n     */\n    function PublisherHintsSignaling(getReceiver, options) {\n        var _this = _super.call(this, getReceiver, 'publisher_hints', options) || this;\n        _this.on('ready', function (transport) {\n            _this._log.debug('publisher_hints transport ready:', transport);\n            transport.on('message', function (message) {\n                _this._log.debug('Incoming: ', message);\n                switch (message.type) {\n                    case 'publisher_hints':\n                        if (message.publisher && message.publisher.hints && message.publisher.id) {\n                            _this._processPublisherHints(message.publisher.hints, message.publisher.id);\n                        }\n                        break;\n                    default:\n                        _this._log.warn('Unknown message type: ', message.type);\n                        break;\n                }\n            });\n        });\n        return _this;\n    }\n    PublisherHintsSignaling.prototype.sendTrackReplaced = function (_a) {\n        var trackSid = _a.trackSid;\n        if (!this._transport) {\n            return;\n        }\n        var payLoad = {\n            type: 'client_reset',\n            track: trackSid,\n            id: messageId++\n        };\n        this._log.debug('Outgoing: ', payLoad);\n        this._transport.publish(payLoad);\n    };\n    PublisherHintsSignaling.prototype.sendHintResponse = function (_a) {\n        var id = _a.id, hints = _a.hints;\n        if (!this._transport) {\n            return;\n        }\n        var payLoad = {\n            type: 'publisher_hints',\n            id: id,\n            hints: hints\n        };\n        this._log.debug('Outgoing: ', payLoad);\n        this._transport.publish(payLoad);\n    };\n    /**\n     * @private\n     */\n    PublisherHintsSignaling.prototype._processPublisherHints = function (hints, id) {\n        try {\n            this.emit('updated', hints, id);\n        }\n        catch (ex) {\n            this._log.error('error processing hints:', ex);\n        }\n    };\n    return PublisherHintsSignaling;\n}(MediaSignaling));\nmodule.exports = PublisherHintsSignaling;\n//# sourceMappingURL=publisherhintsignaling.js.map"]},"metadata":{},"sourceType":"script"}